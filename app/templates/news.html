<!DOCTYPE html>
<html lang="en">
{% extends "base.html" %}

<head>

    {% block head %}

    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="/static/css/news.css">
    <link rel="stylesheet" type="text/css" href="/static/css/navigation.css">
    <link rel="stylesheet" type="text/css" href="/static/css/dialog.css">
    <script type="text/javascript" src="/static/js/dialog.js"></script>
    <script>


            function show_new() {

            document.getElementById("new_news").style.opacity = 1;
            document.getElementById("old_news").style.opacity = 0;
            document.getElementById("old_news").style.visibility = "hidden";
            document.getElementById("new_news").style.visibility = "visible";
        }
        function show_old() {

            document.getElementById("new_news").style.opacity = 0;
            document.getElementById("old_news").style.opacity = 1;
            document.getElementById("old_news").style.visibility = "visible";
            document.getElementById("new_news").style.visibility = "hidden";
        }









    </script>
    <title>Новости</title>

    {% endblock %}
</head>

<body data-template="bruno2"
      class="f__preset-box f__site f__2 loading locale_ru bruno2 mod--search-disable mod--img-logo mod--header-static mod--menu-action-on-scroll mod--menu-static-on-scroll desktop adaptive-desktop mod--horizontal-menu mod--infoline-disable js--loading-cascade mod--font-none-preset layout-logo-left--by-logo "
      data-preview="">


{% block after %}

<span class="title">Новости</span>
{% if  user.is_authenticated %}
<div class="is-empty">

    <a href="{{url_for('add_news')}}">Создать новость</a>

</div>

{% endif %}
<nav class="category-navigation">
    <ul>
        <li><a onclick="show_new()">Новые</a></li>
        <li><a onclick="show_old()">Более старые</a></li>
    </ul>
</nav>
<div id="news-blocks">


    <div class="news-list" id="new_news">
        {% if news %}
        {% for n in news %}
        <dialog id="confirm-dialog-{{n.id}}-remove" class="confirm-dialog">
            <p class="dialog-title">Внимание</p>
            <p>Вы действительно хотите удалить эту новость?</p>
            <div class="buttons">
                <a onclick="close_confirm_dialog({{n.id}}, 'remove');">Отмена</a>
                <a href="{{url_for('news', action='remove', id=n.id)}}">Да</a>
            </div>


        </dialog>

        <div class="item-block">

            {% if (n.timestamp.year, n.timestamp.month, n.timestamp.day) == (today.year, today.month, today.day) %}
            <span class="news-date" style="color: red;">Сегодня</span>
            {% elif (n.timestamp.year, n.timestamp.month, n.timestamp.day) == (today.year, today.month, today.day - 1)
            %}
            <span class="news-date">Вчера</span>
            {% else %}
            <span class="news-date">{{morph.parse(n.timestamp.strftime("%d %B"))[0].inflect(case).word + " " + n.timestamp.strftime("%Y года")}} </span>
            {% endif %}
            {% if user.is_authenticated %}


            <div class="tools">
                <a href="{{url_for('add_news', action='edit', id=n.id)}}">
                    <i class="fa-solid fa-pen"></i>
                </a>
                <a onclick="open_confirm_dialog({{n.id}}, 'remove');">
                    <i class="fa fa-trash-o"></i>
                </a>
            </div>
            {% endif %}

            <div class="content">

                <img class=" cover" src="{{ n.cover }}">

                <div class="news">
                    <h2 class="title-block">{{ n.title }}</h2>
                    <div class="news-body">
                        <!--                        Текст новости чисто без разметки -->
                        <p>
                            {{beautiful_soup(n.body, 'html.parser').get_text('<br>') | safe}}
                        </p>
                    </div>
                    <a class="view-all" href="{{url_for('news', action='show', id=n.id)}}">Читать дальше</a>
                </div>


            </div>

        </div>

        {% endfor %}
        {% else %}
        <div class="is-empty">
            <p>Пока новостей нет</p>

        </div>
        {% endif %}
    </div>
    <div class="news-list" id="old_news" style="visibility: hidden; opacity: 0;">
        {% if old_news %}
        {% for n in old_news %}

        <dialog id="confirm-dialog-{{n.id}}-remove" class="confirm-dialog">
            <p class="dialog-title">Внимание</p>
            <p>Вы действительно хотите удалить эту новость?</p>
            <div class="buttons">
                <a onclick="close_confirm_dialog({{n.id}}, 'remove');">Отмена</a>
                <a href="{{url_for('news', action='remove', id=n.id)}}">Да</a>
            </div>


        </dialog>

        <div class="item-block">

            {% if (n.timestamp.year, n.timestamp.month, n.timestamp.day) == (today.year, today.month, today.day) %}
            <span class="news-date" style="color: red;">Сегодня</span>
            {% elif (n.timestamp.year, n.timestamp.month, n.timestamp.day) == (today.year, today.month, today.day - 1)
            %}
            <span class="news-date">Вчера</span>
            {% else %}
            <span class="news-date">{{morph.parse(n.timestamp.strftime("%d %B"))[0].inflect(case).word + " " + n.timestamp.strftime("%Y года")}} </span>
            {% endif %}
            {% if user.is_authenticated %}


            <div class="tools">
                <a href="{{url_for('add_news', action='edit', id=n.id)}}">
                    <i class="fa-solid fa-pen"></i>
                </a>
                <a onclick="open_confirm_dialog({{n.id}}, 'remove');">
                    <i class="fa fa-trash-o"></i>
                </a>
            </div>
            {% endif %}

            <div class="content">

                <img class=" cover" src="{{ n.cover }}">

                <div class="news">
                    <h2 class="title-block">{{ n.title }}</h2>
                    <div class="news-body">
                        <!--                        Текст новости чисто без разметки -->
                        {{beautiful_soup(n.body).get_text()}}
                    </div>
                    <a class="view-all" href="{{url_for('news', action='show', id=n.id)}}"><h3>Читать дальше</h3></a>
                </div>


            </div>

        </div>

        {% endfor %}
        {% else %}
        <div class="is-empty">
            <p>Пока новостей нет</p>

        </div>
        {% endif %}
    </div>
</div>


{% endblock %}


</body>
</html>